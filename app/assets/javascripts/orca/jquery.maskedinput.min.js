!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t,n=navigator.userAgent,a=/iphone/i.test(n),r=/chrome/i.test(n),i=/android/i.test(n);jQuery.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},jQuery.fn.extend({caret:function(e,t){var n;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&((n=this.createTextRange()).collapse(!0),n.moveEnd("character",t),n.moveStart("character",e),n.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),e=0-n.duplicate().moveStart("character",-1e5),t=e+n.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(e,n){var o,u,c,l,f,s,h,g;if(!e&&this.length>0){var m=(o=jQuery(this[0])).data(jQuery.mask.dataName);return m?m():void 0}return n=jQuery.extend({autoclear:jQuery.mask.autoclear,placeholder:jQuery.mask.placeholder,completed:null},n),u=jQuery.mask.definitions,c=[],l=h=e.length,f=null,jQuery.each(e.split(""),function(e,t){"?"==t?(h--,l=e):u[t]?(c.push(new RegExp(u[t])),null===f&&(f=c.length-1),l>e&&(s=c.length-1)):c.push(null)}),this.trigger("unmask").each(function(){function o(){if(n.completed){for(var e=f;s>=e;e++)if(c[e]&&R[e]===m(e))return;n.completed.call(x)}}function m(e){return n.placeholder.charAt(e<n.placeholder.length?e:0)}function d(e){for(;++e<h&&!c[e];);return e}function p(e){for(;--e>=0&&!c[e];);return e}function v(e,t){var n,a;if(!(0>e)){for(n=e,a=d(t);h>n;n++)if(c[n]){if(!(h>a&&c[n].test(R[a])))break;R[n]=R[a],R[a]=m(a),a=d(a)}j(),x.caret(Math.max(f,e))}}function y(e){var t,n,a,r;for(t=e,n=m(e);h>t;t++)if(c[t]){if(a=d(t),r=R[t],R[t]=n,!(h>a&&c[a].test(r)))break;n=r}}function b(){Q(),x.val()!=A&&x.change()}function k(e,t){var n;for(n=e;t>n&&h>n;n++)c[n]&&(R[n]=m(n))}function j(){x.val(R.join(""))}function Q(e){var t,a,r,i=x.val(),o=-1;for(t=0,r=0;h>t;t++)if(c[t]){for(R[t]=m(t);r++<i.length;)if(a=i.charAt(r-1),c[t].test(a)){R[t]=a,o=t;break}if(r>i.length){k(t+1,h);break}}else R[t]===i.charAt(r)&&r++,l>t&&(o=t);return e?j():l>o+1?n.autoclear||R.join("")===S?(x.val()&&x.val(""),k(0,h)):j():(j(),x.val(x.val().substring(0,o+1))),l?t:f}var x=jQuery(this),R=jQuery.map(e.split(""),function(e,t){return"?"!=e?u[e]?m(t):e:void 0}),S=R.join(""),A=x.val();x.data(jQuery.mask.dataName,function(){return jQuery.map(R,function(e,t){return c[t]&&e!=m(t)?e:null}).join("")}),x.one("unmask",function(){x.off(".mask").removeData(jQuery.mask.dataName)}).on("focus.mask",function(){if(!x.prop("readonly")){clearTimeout(t);var n;A=x.val(),n=Q(),t=setTimeout(function(){j(),n==e.replace("?","").length?x.caret(0,n):x.caret(n)},10)}}).on("blur.mask",b).on("keydown.mask",function(e){if(!x.prop("readonly")){var t,n,r,i=e.which||e.keyCode;g=x.val(),8===i||46===i||a&&127===i?(t=x.caret(),n=t.begin,(r=t.end)-n==0&&(n=46!==i?p(n):r=d(n-1),r=46===i?d(r):r),k(n,r),v(n,r-1),e.preventDefault()):13===i?b.call(this,e):27===i&&(x.val(A),x.caret(0,Q()),e.preventDefault())}}).on("keypress.mask",function(e){if(!x.prop("readonly")){var t,n,a,r=e.which||e.keyCode,u=x.caret();e.ctrlKey||e.altKey||e.metaKey||32>r||!r||13===r||(u.end-u.begin!=0&&(k(u.begin,u.end),v(u.begin,u.end-1)),t=d(u.begin-1),h>t&&(n=String.fromCharCode(r),c[t].test(n))&&(y(t),R[t]=n,j(),a=d(t),i?setTimeout(function(){jQuery.proxy(jQuery.fn.caret,x,a)()},0):x.caret(a),u.begin<=s&&o()),e.preventDefault())}}).on("input.mask paste.mask",function(){x.prop("readonly")||setTimeout(function(){var e=Q(!0);x.caret(e),o()},0)}),r&&i&&x.off("input.mask").on("input.mask",function(){var e=x.val(),t=x.caret();if(e.length<g.length){for(Q(!0);t.begin>0&&!c[t.begin-1];)t.begin--;if(0===t.begin)for(;t.begin<f&&!c[t.begin];)t.begin++;x.caret(t.begin,t.begin)}else{for(Q(!0);t.begin<h&&!c[t.begin];)t.begin++;x.caret(t.begin,t.begin)}o()}),Q()})}})});